(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{423:function(s,t,a){"use strict";a.r(t);var e=a(1),n=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"kubernetesæ§åˆ¶å™¨-service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kubernetesæ§åˆ¶å™¨-service"}},[s._v("#")]),s._v(" kubernetesæ§åˆ¶å™¨-Service")]),s._v(" "),t("blockquote",[t("p",[s._v("Service æ˜¯ å°†è¿è¡Œåœ¨ä¸€ä¸ªæˆ–ä¸€ç»„ "),t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/workloads/pods/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Pod"),t("OutboundLink")],1),s._v(" ä¸Šçš„ç½‘ç»œåº”ç”¨ç¨‹åºå…¬å¼€ä¸ºç½‘ç»œæœåŠ¡çš„æ–¹æ³•ã€‚")])]),s._v(" "),t("p",[s._v("ä½¿ç”¨Deploymentéƒ¨ç½²Podæ—¶ï¼ŒPodå¤§éƒ¨åˆ†éƒ½æ˜¯éšæœºåœ°éƒ¨ç½²åˆ°èŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸”ç»å¸¸è¢«åˆ é™¤é‡å»ºï¼Œè¿™å°±å¯¼è‡´äº†å®¹å™¨é—´è®¿é—®éœ€è¦ä¸€ç§å›ºå®šä¸å˜çš„èµ„æºç±»å‹æ¥è®¿é—®ã€‚")]),s._v(" "),t("p",[s._v("è€Œkuberneteså®šä¹‰äº†ä¸€ç§å¯¹è±¡ç±»å‹ï¼Œé€šè¿‡Serviceæ¥è®¿é—®Podï¼Œè€ŒServiceå……å½“è´Ÿè½½å‡è¡¡å™¨æ¥æŠŠè¿æ¥è½¬å‘åˆ°å…¶ä¸­ä»»æ„ä¸€ä¸ªPodå½“ä¸­ã€‚")]),s._v(" "),t("div",{staticClass:"center-container"},[t("img",{staticStyle:{zoom:"33%"},attrs:{src:"https://static.xiaoliutalk.cn/img/202309061418518.png"}})]),t("h2",{attrs:{id:"_1-åˆ›å»ºservice"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-åˆ›å»ºservice"}},[s._v("#")]),s._v(" 1. åˆ›å»ºService")]),s._v(" "),t("h3",{attrs:{id:"_1-1-å¸¦æœ‰æ ‡ç­¾é€‰æ‹©å™¨çš„service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-å¸¦æœ‰æ ‡ç­¾é€‰æ‹©å™¨çš„service"}},[s._v("#")]),s._v(" 1.1. å¸¦æœ‰æ ‡ç­¾é€‰æ‹©å™¨çš„Service")]),s._v(" "),t("p",[s._v("ä¸Deploymentç›¸åŒï¼Œ"),t("strong",[s._v("Serviceä¹Ÿé€šè¿‡æ ‡ç­¾é€‰æ‹©å™¨è¿›è¡ŒåŒ¹é…Pod")]),s._v("ï¼Œæ–°å»º "),t("code",[s._v("Service.yml")]),s._v(" ï¼š")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app.kubernetes.io/name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MyApp\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9376")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("p",[s._v("è¿™ä¸ªymlæ–‡ä»¶åˆ›å»ºäº†ä¸€ä¸ªåç§°ä¸º "),t("code",[s._v("my-service")]),s._v(" çš„Serviceï¼Œå¹¶åŒ¹é…æ‰€æœ‰æ ‡ç­¾ä¸º "),t("code",[s._v("app.kubernetes.io/name: MyApp")]),s._v(" çš„Podï¼Œå¹¶æŠŠPodçš„9376ç«¯å£ï¼ˆåè®®ç±»å‹ä¸ºTCPï¼‰åå‘ä»£ç†åˆ°80ç«¯å£ã€‚")]),s._v(" "),t("p",[s._v("åˆ›å»ºè¿™ä¸ªServiceï¼Œå¹¶æŸ¥çœ‹Serviceçš„çŠ¶æ€ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" Service.yml\nkubectl get services\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"center-container"},[t("p",[t("img",{attrs:{src:"https://static.xiaoliutalk.cn/img/202309061443455.png",alt:""}})])]),t("ul",[t("li",[t("strong",[s._v("TYPE")]),s._v("ï¼šService ç±»å‹ï¼Œé»˜è®¤ä¸º"),t("strong",[s._v("ClusterIP")]),s._v("ï¼Œå³"),t("strong",[s._v("åªèƒ½åœ¨é›†ç¾¤å†…éƒ¨è¿›è¡Œè®¿é—®")]),s._v("ï¼Œé€šè¿‡ "),t("code",[s._v("CLUSTER-IP:PORT")]),s._v(" è¿›è¡Œè®¿é—®ï¼Œæˆ–è€…é€šè¿‡ "),t("code",[s._v("NAME:PORT")]),s._v(" è¿›è¡Œè®¿é—®ã€‚")])]),s._v(" "),t("p",[s._v("ä¹Ÿå¯ä»¥åœ¨Podä¸­ "),t("code",[s._v(".spec.containers[].ports[].name")]),s._v(" è‡ªå®šä¹‰ç«¯å£çš„åç§°ï¼Œä¹‹ååœ¨Serviceä¸­æ ¹æ®åç§°è¿›è¡Œè°ƒç”¨ï¼Œé€šè¿‡è‡ªå®šä¹‰ç«¯å£çš„åç§°å¯ä»¥æå¤§æé«˜Serviceé…ç½®çš„çµæ´»æ€§ï¼Œä¾‹å¦‚æˆ‘æ›´æ–°äº†Podçš„ç«¯å£ï¼Œå°±ä¸å†éœ€è¦å†æ¬¡æ›´æ–°Serviceçš„targetPortï¼Œå‡å°‘äº†é…ç½®çš„å·¥ä½œé‡ï¼š")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app.kubernetes.io/name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" proxy\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("stable\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containerPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("svc\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app.kubernetes.io/name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" proxy\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" name"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("of"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("port\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("web"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("svc\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("h3",{attrs:{id:"_1-2-ä¸å¸¦æ ‡ç­¾é€‰æ‹©å™¨çš„service"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-ä¸å¸¦æ ‡ç­¾é€‰æ‹©å™¨çš„service"}},[s._v("#")]),s._v(" 1.2. ä¸å¸¦æ ‡ç­¾é€‰æ‹©å™¨çš„Service")]),s._v(" "),t("p",[s._v("é€šè¿‡ä¸è®¾ç½®æ ‡ç­¾é€‰æ‹©å™¨å¯ä»¥è‡ªå®šä¹‰åŒ¹é…Serviceçš„åç«¯æœåŠ¡ï¼Œç›¸å½“äºè‡ªå®šä¹‰äº†ä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ã€‚")]),s._v(" "),t("p",[s._v("è€Œè¿™ä¸ªè´Ÿè½½å‡è¡¡å™¨åˆé€šè¿‡å®šä¹‰ "),t("code",[s._v("EndpointSlice")]),s._v(" å¯¹è±¡å’Œ "),t("code",[s._v("Endpoints")]),s._v(" å¯¹è±¡æ¥æŠŠè¿æ¥è½¬å‘åˆ°å…¶ä¸­ä»»æ„ä¸€ä¸ªIPåœ°å€å½“ä¸­ã€‚")]),s._v(" "),t("p",[s._v("å¯ä»¥åº”ç”¨åœ¨ä»¥ä¸‹åœºæ™¯ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("å¸Œæœ›åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨æŸä¸ªå›ºå®šçš„åç§°è€ŒéIPåœ°å€è®¿é—®å¤–éƒ¨çš„ä¸­é—´ä»¶æœåŠ¡ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("ä½¿ç”¨å…¶ä»–å‘½åç©ºé—´æˆ–è€…å…¶ä»–é›†ç¾¤çš„æœåŠ¡ï¼›")])]),s._v(" "),t("li",[t("p",[s._v("ä»åŸºç¡€ç¯å¢ƒè¿ç§»åˆ°kubernetesæ—¶ï¼Œéœ€è¦å°†ä¸€éƒ¨åˆ†æµé‡è½¬å‘åˆ°å¤–éƒ¨æœåŠ¡å½“ä¸­ï¼›")])])]),s._v(" "),t("h4",{attrs:{id:"_1-2-1-endpoints"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-1-endpoints"}},[s._v("#")]),s._v(" 1.2.1. Endpoints")]),s._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/reference/kubernetes-api/service-resources/endpoints-v1/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Endpoints"),t("OutboundLink")],1),s._v(" ï¼ˆè¯¥èµ„æºç±»åˆ«ä¸ºå¤æ•°ï¼‰å®šä¹‰äº†ç½‘ç»œç«¯ç‚¹çš„åˆ—è¡¨ï¼Œé€šå¸¸ç”± Service å¼•ç”¨ï¼Œä»¥å®šä¹‰å¯ä»¥å°†æµé‡å‘é€åˆ°å“ªäº› Podã€‚")])]),s._v(" "),t("p",[s._v("ç®€å•æ¥è¯´ï¼ŒEndpointså¯¹è±¡åŒ…å«äº†éœ€è¦è¿›è¡Œåå‘ä»£ç†çš„IPå’Œç«¯å£ã€‚è€Œé’ˆå¯¹Endpointså¯¹è±¡ï¼Œåˆæ ¹æ®Serviceçš„æƒ…å†µåˆ†ä¸ºä¸¤ç§Endpointsï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("Serviceå¸¦æœ‰æ ‡ç­¾é€‰æ‹©å™¨")]),s._v("ï¼šç”±kubernetesç®¡ç†ï¼Œæœ‰ä¸ServiceåŒ¹é…çš„Podæ–°å»ºæˆ–è€…åˆ é™¤æ—¶ï¼Œkuberneteséƒ½ä¼šè‡ªè¡Œæ›´æ–°Endpointså¯¹è±¡ä¸­çš„ä¿¡æ¯ï¼Œæ¥åšåˆ°åŠ¨æ€çš„è´Ÿè½½å‡è¡¡ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("Serviceä¸å¸¦æ ‡ç­¾é€‰æ‹©å™¨")]),s._v("ï¼šå¦‚æœåˆ›å»ºäº†ä¸åŒ…å«æ ‡ç­¾é€‰æ‹©å™¨çš„Serviceï¼Œkuberneteså°†ä¸ä¼šè‡ªåŠ¨åˆ›å»ºEndpointså¯¹è±¡ï¼Œè€Œè¿™ç§æ–¹å¼å¯ä»¥é€šè¿‡æ‰‹åŠ¨åˆ›å»ºEndpointså¯¹è±¡æ¥å®ç°Serviceä¸Endpointsçš„å¯¹è±¡ç›¸åŒ¹é…ã€‚")])]),s._v(" "),t("p",[s._v("ä¸‹é¢æˆ‘ä»¬ä¸»è¦çœ‹ä¸€ä¸‹ä¸å¸¦æ ‡ç­¾é€‰æ‹©å™¨çš„Serviceæ˜¯å¦‚ä½•ä¸Endpointså»ºç«‹è¿æ¥çš„ï¼Œæ–°å»º "),t("code",[s._v("ServiceWithoutSelector_Endpoints.yml")]),s._v("ï¼š")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Serviceçš„åç§°å¿…é¡»ä¸Endpointsçš„åç§°ç›¸åŒ¹é…")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Serviceå¯¹å¤–æš´éœ²çš„ç«¯å£")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Endpoints\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Endpointsçš„åç§°å¿…é¡»ä¸Serviceçš„åç§°ç›¸åŒ¹é…")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("subsets")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("addresses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ip")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10.1.1.1        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¢«åå‘ä»£ç†çš„ipåœ°å€")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ip")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" 10.1.1.2        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¢«åå‘ä»£ç†çš„ipåœ°å€")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("            "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¢«åå‘ä»£ç†çš„ç«¯å£")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br")])]),t("p",[s._v("åˆ›å»ºè¿™ä¸ªServiceï¼Œå¹¶æŸ¥çœ‹Serviceå’ŒEndpointsçš„çŠ¶æ€ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl apply "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" ServiceWithoutSelector_Endpoints.yml\nkubectl get services\nkubectl get endpoints\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("div",{staticClass:"center-container"},[t("p",[t("img",{attrs:{src:"https://static.xiaoliutalk.cn/img/202309061839821.png",alt:""}})])]),t("p",[s._v("é€šè¿‡è®¿é—® "),t("code",[s._v("CLUSTER-IP:PORT")]),s._v(" å³å¯æ­£å¸¸è®¿é—®å¯¹åº”çš„Serviceã€‚")]),s._v(" "),t("h4",{attrs:{id:"_1-2-2-endpointslice"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-2-endpointslice"}},[s._v("#")]),s._v(" 1.2.2. EndpointSlice")]),s._v(" "),t("blockquote",[t("p",[t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/services-networking/endpoint-slices/",target:"_blank",rel:"noopener noreferrer"}},[s._v("EndpointSlice"),t("OutboundLink")],1),s._v(" å¯¹è±¡è¡¨ç¤ºæŸä¸ªæœåŠ¡çš„åç«¯ç½‘ç»œç«¯ç‚¹çš„å­é›†ï¼ˆ"),t("strong",[s._v("åˆ‡ç‰‡")]),s._v("ï¼‰ã€‚")])]),s._v(" "),t("p",[s._v("ä¾‹å¦‚ç”µå•†è¡Œä¸šåœ¨è¿›è¡Œä¿ƒé”€æ´»åŠ¨æˆ–ç§’æ€æŠ¢è´­æ´»åŠ¨æ—¶ï¼Œä¸šåŠ¡æµé‡ç›¸å¯¹è¾ƒå¤§ã€‚ä¸ºäº†åº”å¯¹è¿™ç§åœºæ™¯ï¼Œé€šå¸¸ä¼šè®¾ç½®å¼¹æ€§æ‰©å®¹ã€‚åœ¨æ´»åŠ¨è¿›è¡Œæ—¶ï¼ŒæœåŠ¡ä¼šè¿›è¡Œå¼¹æ€§ä¼¸ç¼©ç›´åˆ°èƒ½å¤Ÿæ‰¿è½½æµé‡ï¼Œè¿™æ—¶ä¼šåŸºäºå¼¹æ€§æ‰©å®¹çš„ç­–ç•¥ï¼Œä¸ºä¸šåŠ¡å¢åŠ å‰¯æœ¬æ•°ï¼Œä¹Ÿå°±æ˜¯ Pod ä¼šå˜å¤šã€‚")]),s._v(" "),t("p",[s._v("æ¯ä¸ª Pod éƒ½æœ‰å„è‡ªå”¯ä¸€çš„ IP ï¼Œä½†åŒæ—¶ Pod çš„ IP ä¹Ÿä¸æ˜¯å›ºå®šçš„ã€‚ä¸ºäº†åŠæ—¶è¿½è¸ª Pod IP çš„å˜åŒ–ï¼Œä»è€Œè¿›è¡Œè´Ÿè½½å‡è¡¡ï¼ŒEndpoints API æä¾›äº†åœ¨ Kubernetes ä¸­è·Ÿè¸ªç½‘ç»œç«¯ç‚¹çš„ä¸€ç§ç®€å•è€Œç›´æ¥çš„æ–¹æ³•ã€‚")]),s._v(" "),t("p",[s._v("ä½†éšç€ Kubernetes é›†ç¾¤å’ŒæœåŠ¡é€æ¸å¼€å§‹ä¸ºæ›´å¤šçš„åç«¯ Pod è¿›è¡Œå¤„ç†å’Œå‘é€è¯·æ±‚ï¼Œæ¯”å¦‚ä¸Šæ–‡æåˆ°å¤§æµé‡åœºæ™¯ä¸‹ï¼ŒPod æ•°é‡ä¼šè¢«ä¸æ–­æ‰©å®¹ï¼ŒEndpoints API ä¹Ÿå°†å˜å¾—è¶Šå¤§ã€‚è¿™ç§æƒ…å†µä¸‹ï¼ŒEndpoints API å±€é™æ€§å˜å¾—è¶Šæ¥è¶Šæ˜æ˜¾ï¼Œç”šè‡³æˆä¸ºæ€§èƒ½ç“¶é¢ˆã€‚")]),s._v(" "),t("p",[s._v("ä¸ºäº†è§£å†³è¿™ä¸ªå±€é™æ€§é—®é¢˜ï¼Œåœ¨ Kubernetes v1.21 çš„ç‰ˆæœ¬ä¸­å¼•å…¥äº†å¯¹ Endpointslice API çš„æ”¯æŒï¼Œè§£å†³äº† Endpoints API å¤„ç†å¤§é‡ç½‘ç»œç«¯ç‚¹å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼ŒåŒæ—¶æä¾›äº†å¯æ‰©å±•å’Œå¯ä¼¸ç¼©çš„èƒ½åŠ›ã€‚")]),s._v(" "),t("p",[t("strong",[s._v("Endpoints åœ¨æµé‡é«˜å³°æ—¶çš„å˜åŒ–ï¼š")])]),s._v(" "),t("div",{staticClass:"center-container"},[t("p",[t("img",{attrs:{src:"https://static.xiaoliutalk.cn/img/202309071002398.png",alt:""}})])]),t("p",[t("strong",[s._v("Endpointslices åœ¨æµé‡é«˜å³°æ—¶çš„å˜åŒ–ï¼š")])]),s._v(" "),t("div",{staticClass:"center-container"},[t("p",[t("img",{attrs:{src:"https://static.xiaoliutalk.cn/img/202309071002659.png",alt:""}})])]),t("p",[s._v("ä¸‹é¢æˆ‘ä»¬ä¸»è¦çœ‹ä¸€ä¸‹ä¸å¸¦æ ‡ç­¾é€‰æ‹©å™¨çš„Serviceæ˜¯å¦‚ä½•ä¸EndpointSliceå»ºç«‹è¿æ¥çš„ï¼Œæ–°å»º "),t("code",[s._v("ServiceWithoutSelector_EndpointSlice.yml")]),s._v("ï¼š")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Serviceçš„åç§°å¿…é¡»ä¸Endpointsçš„æ ‡ç­¾kubernetes.io/service-nameç›¸åŒ¹é…")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("---")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" discovery.k8s.io/v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" EndpointSlice\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# æŒ‰æƒ¯ä¾‹å°†Serviceçš„åç§°ç”¨ä½œEndpointSliceåç§°çš„å‰ç¼€")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Endpointsçš„æ ‡ç­¾kubernetes.io/service-nameå¿…é¡»ä¸Serviceçš„åç§°ç›¸åŒ¹é…")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kubernetes.io/service-name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("addressType")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" IPv4                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åœ°å€ç±»å‹ï¼Œå¯ä»¥é…ç½®IPv4ï¼ŒIPv6ï¼ŒFQDNä¸‰ç§å‚æ•°")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("appProtocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" http                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å…³è”çš„æœåŠ¡çš„åè®®")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# åè®®ç±»å‹")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8443")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("endpoints")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("addresses")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.1.1.1"')]),s._v("                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¢«åå‘ä»£ç†çš„ipåœ°å€")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"10.1.1.2"')]),s._v("                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# è¢«åå‘ä»£ç†çš„ipåœ°å€")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("p",[s._v("éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒServiceçš„åç§°ä¸Endpointsçš„æ ‡ç­¾ "),t("code",[s._v("kubernetes.io/service-name")]),s._v(" ç›¸åŒ¹é…ï¼Œä¸EndpointsåŒ¹é…æ–¹å¼ç•¥æœ‰ä¸åŒã€‚")]),s._v(" "),t("p",[s._v("åŒæ ·åˆ›å»ºè¿™ä¸ªServiceï¼Œå¹¶æŸ¥çœ‹Serviceå’ŒEndpointSliceçš„çŠ¶æ€ï¼š")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl get services\nkubectl get endpointslices\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("div",{staticClass:"center-container"},[t("p",[t("img",{attrs:{src:"https://static.xiaoliutalk.cn/img/202309071555143.png",alt:""}})])]),t("p",[s._v("Serviceä¸EndpointSliceéƒ½æˆåŠŸè¢«åˆ›å»ºå¹¶ä¸”å¯ä»¥æ­£å¸¸è®¿é—®ã€‚")]),s._v(" "),t("h2",{attrs:{id:"_2-serviceçš„ç±»å‹"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-serviceçš„ç±»å‹"}},[s._v("#")]),s._v(" 2. Serviceçš„ç±»å‹")]),s._v(" "),t("p",[s._v("Service Typeï¼ˆæœåŠ¡ç±»å‹ï¼‰ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹å‡ ç§ï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("ClusterIP")]),s._v("ï¼šé»˜è®¤å€¼ï¼Œ"),t("strong",[s._v("åªèƒ½åœ¨é›†ç¾¤å†…éƒ¨è¿›è¡Œè®¿é—®")]),s._v("ã€‚é€šè¿‡ "),t("code",[s._v("CLUSTER-IP:PORT")]),s._v(" è¿›è¡Œè®¿é—®ï¼Œæˆ–è€…é€šè¿‡ "),t("code",[s._v("NAME:PORT")]),s._v(" è¿›è¡Œè®¿é—®ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("NodePort")]),s._v("ï¼šåœ¨æ‰€æœ‰å®‰è£…äº† kube-proxy çš„èŠ‚ç‚¹ä¸Šæ‰“å¼€ä¸€ä¸ªç«¯å£ï¼Œæ­¤ç«¯å£å¯ä»¥ä»£ç†è‡³åç«¯Podï¼Œå¯ä»¥é€šè¿‡NodePortä»é›†ç¾¤å¤–éƒ¨è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡ï¼Œæ ¼å¼ä¸º "),t("code",[s._v("NodeIP:NodePort")]),s._v(" ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("LoadBalancer")]),s._v("ï¼šä½¿ç”¨äº‘æä¾›å•†çš„è´Ÿè½½å‡è¡¡å™¨å…¬å¼€Serviceã€‚")]),s._v(" "),t("li",[t("strong",[s._v("ExternalName")]),s._v("ï¼šé€šè¿‡è¿”å›å®šä¹‰çš„CNAMEåˆ«åï¼Œå°†Serviceæ˜ å°„åˆ°å¯è¢«DNSè§£æçš„å…¶ä»–åŸŸåã€‚")])]),s._v(" "),t("p",[s._v("ClusterIPè¿™é‡Œçœç•¥ï¼Œç›´æ¥åˆ†æä¸‹Serviceå¯¹å¤–æš´éœ²çš„ä¸‰ç§ç±»å‹ï¼Œ"),t("strong",[s._v("NodePort")]),s._v("ï¼Œ"),t("strong",[s._v("LoadBalancer")]),s._v("å’Œ"),t("strong",[s._v("ExternalName")]),s._v("ã€‚")]),s._v(" "),t("h3",{attrs:{id:"_2-1-nodeport"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-nodeport"}},[s._v("#")]),s._v(" 2.1. NodePort")]),s._v(" "),t("p",[s._v("é€šè¿‡åˆ›å»ºServiceï¼Œå¹¶å°†Typeè®¾ç½®ä¸ºNodePortæ¥å®ç°é€šè¿‡NodePortä»é›†ç¾¤å¤–éƒ¨è®¿é—®é›†ç¾¤å†…çš„æœåŠ¡ã€‚")]),s._v(" "),t("div",{staticClass:"center-container"},[t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://static.xiaoliutalk.cn/img/202309071828671.png"}})]),t("p",[s._v("é€šè¿‡å›¾ç‰‡æˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥ï¼Œå°†Typeè®¾ç½®ä¸ºNodePortå¯ä»¥å®ç°åœ¨æ¯ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹ä¸Šéƒ½ä¼šæ‰“å¼€ä¸€ä¸ªNodePortï¼Œè€Œé€šè¿‡è®¿é—®ä»»æ„ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„IP+NodePortå°±å¯ä»¥ä»å¤–éƒ¨è®¿é—®åˆ°åç«¯çš„Podã€‚")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" NodePort\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app.kubernetes.io/name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" MyApp\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼ŒtargetPortè¢«è®¾ç½®ä¸ºä¸portå­—æ®µç›¸åŒçš„å€¼")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# å¯é€‰å­—æ®µï¼Œä¸æŒ‡å®šæ­¤å­—æ®µçš„æƒ…å†µä¸‹ï¼Œkubernetesä¼šä»æŸä¸ªèŒƒå›´å†…åˆ†é…ä¸€ä¸ªç«¯å£å·ï¼ˆé»˜è®¤ï¼š30000-32767ï¼‰")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("nodePort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("30007")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br")])]),t("p",[s._v("å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è®¿é—®æ­¤Serciceï¼š")]),s._v(" "),t("ul",[t("li",[t("strong",[s._v("é›†ç¾¤å†…éƒ¨")]),s._v("ï¼šé€šè¿‡ "),t("code",[s._v("CLUSTER-IP:PORT")]),s._v(" è¿›è¡Œè®¿é—®ï¼Œæˆ–è€…é€šè¿‡ "),t("code",[s._v("NAME:PORT")]),s._v(" è¿›è¡Œè®¿é—®ã€‚")]),s._v(" "),t("li",[t("strong",[s._v("é›†ç¾¤å¤–éƒ¨")]),s._v("ï¼šä»»æ„ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹çš„å®¿ä¸»æœºIP+NodePortè¿›è¡Œè®¿é—®ã€‚")])]),s._v(" "),t("h3",{attrs:{id:"_2-2-loadbalancer"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-loadbalancer"}},[s._v("#")]),s._v(" 2.2. LoadBalancer")]),s._v(" "),t("blockquote",[t("p",[t("strong",[s._v("LoadBalanceråº•å±‚ä¾èµ–äºNodePortã€‚")])])]),s._v(" "),t("p",[s._v("ä½¿ç”¨NodePortå°±åˆæ¶‰åŠåˆ°è´Ÿè½½å‡è¡¡çš„é—®é¢˜ï¼Œè€ŒLoadBalancerå°±æ˜¯ä¸ºäº†è§£å†³K8så°†å†…éƒ¨æœåŠ¡å¯¹å¤–æš´éœ²æ—¶å¦‚ä½•è¿›è¡Œè´Ÿè½½å‡è¡¡çš„é—®é¢˜è€Œå‡ºç°çš„ã€‚")]),s._v(" "),t("div",{staticClass:"center-container"},[t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://static.xiaoliutalk.cn/img/202309081812542.png"}})]),t("p",[s._v("å‡è®¾æˆ‘ä»¬æœ‰ä¸€å¥—é˜¿é‡Œäº‘K8sç¯å¢ƒï¼Œè¦å°†K8så†…éƒ¨çš„ä¸€ä¸ªæœåŠ¡é€šè¿‡LoadBalanceræ–¹å¼æš´éœ²å‡ºå»ï¼Œå¯ä»¥å°†Service typeè®¾å®šä¸ºLoadBalancerã€‚æœåŠ¡å‘å¸ƒåï¼Œé˜¿é‡Œäº‘K8sä¸ä»…ä¼šè‡ªåŠ¨åˆ›å»ºæœåŠ¡çš„NodePortç«¯å£è½¬å‘ï¼ŒåŒæ—¶ä¼šè‡ªåŠ¨å¸®æˆ‘ä»¬ç”³è¯·ä¸€ä¸ªSLBï¼Œæœ‰ç‹¬ç«‹å…¬ç½‘IPï¼Œå¹¶ä¸”é˜¿é‡Œäº‘K8sä¼šå¸®æˆ‘ä»¬è‡ªåŠ¨æŠŠSLBæ˜ å°„åˆ°åå°K8sé›†ç¾¤çš„å¯¹åº”NodePortä¸Šã€‚è¿™æ ·ï¼Œé€šè¿‡SLBçš„å…¬ç½‘IPï¼Œæˆ‘ä»¬å°±å¯ä»¥è®¿é—®åˆ°K8så†…éƒ¨æœåŠ¡ï¼Œé˜¿é‡Œäº‘SLBè´Ÿè½½å‡è¡¡å™¨ä¼šåœ¨èƒŒååšè´Ÿè½½å‡è¡¡ã€‚")]),s._v(" "),t("p",[s._v("å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¦‚æœæ˜¯åœ¨æœ¬åœ°å¼€å‘æµ‹è¯•ç¯å¢ƒé‡Œå¤´æ­å»ºçš„K8sï¼Œä¸€èˆ¬ä¸æ”¯æŒLoadBalancerï¼Œå› ä¸ºé€šè¿‡NodePortåšæµ‹è¯•è®¿é—®å°±å¤Ÿäº†ã€‚ä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒæˆ–è€…å…¬æœ‰äº‘ä¸Šçš„K8sï¼Œä¾‹å¦‚GCPæˆ–è€…é˜¿é‡Œäº‘K8sï¼ŒåŸºæœ¬éƒ½æ”¯æŒè‡ªåŠ¨åˆ›å»ºLoadBalancerã€‚")]),s._v(" "),t("p",[s._v("å¦‚æœæ˜¯è‡ªå»ºé›†ç¾¤ï¼Œå¯ä»¥é€šè¿‡å®‰è£… "),t("a",{attrs:{href:"https://metallb.universe.tf/",target:"_blank",rel:"noopener noreferrer"}},[s._v("MetalLB"),t("OutboundLink")],1),s._v(" æ¥ä½¿ç”¨ LoadBalancerã€‚è¿™é‡Œæš‚æ—¶ä¸è·Ÿè¿›è®²è§£è‡ªå»ºé›†ç¾¤çš„LoadBalancerç›¸å…³é…ç½®ã€‚")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("labels")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("nginx"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("svc\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("namespace")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" default\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" LoadBalancer\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("p",[s._v("å…¬æœ‰äº‘å…·ä½“é…ç½®å¯ä»¥å‚è€ƒé˜¿é‡Œäº‘å®˜æ–¹æä¾›çš„ "),t("a",{attrs:{href:"https://help.aliyun.com/zh/ack/ack-managed-and-ack-dedicated/user-guide/use-an-automatically-created-slb-instance-to-expose-an-application?spm=a2c4g.11186623.0.0.13ee8d540KmX6w",target:"_blank",rel:"noopener noreferrer"}},[s._v("é€šè¿‡ä½¿ç”¨è‡ªåŠ¨åˆ›å»ºSLBçš„æœåŠ¡å…¬å¼€åº”ç”¨"),t("OutboundLink")],1),s._v(" è¿™ç¯‡æ–‡ç« è¿›è¡Œé…ç½®ã€‚")]),s._v(" "),t("h3",{attrs:{id:"_2-3-externalname"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-externalname"}},[s._v("#")]),s._v(" 2.3. ExternalName")]),s._v(" "),t("p",[s._v("é€šè¿‡è¿”å›å®šä¹‰çš„CNAMEåˆ«åï¼Œå°†Serviceæ˜ å°„åˆ°å¯è¢«DNSè§£æçš„å…¶ä»–åŸŸåã€‚")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("type")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" ExternalName\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("externalName")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my.database.example.com\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[s._v("è¿™ä¸ªymlæŠŠåç§°ä¸ºmy-serviceçš„Serviceæ˜ å°„åˆ°äº†my.database.example.comè¿™ä¸ªåŸŸåã€‚")]),s._v(" "),t("h3",{attrs:{id:"_2-4-externalips"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-externalips"}},[s._v("#")]),s._v(" 2.4. externalIPs")]),s._v(" "),t("blockquote",[t("p",[s._v("å®šä¹‰ Service æ—¶ï¼Œä½ å¯ä»¥ä¸ºä»»ä½•"),t("a",{attrs:{href:"https://kubernetes.io/zh-cn/docs/concepts/services-networking/service/#publishing-services-service-types",target:"_blank",rel:"noopener noreferrer"}},[s._v("æœåŠ¡ç±»å‹"),t("OutboundLink")],1),s._v("æŒ‡å®š externalIPsã€‚")])]),s._v(" "),t("p",[s._v("externalIPså¯ä»¥è¯´æ˜¯Serviceç±»å‹çš„æ‰©å……ã€‚")]),s._v(" "),t("p",[s._v("å¦‚æœæœ‰å¤–éƒ¨å¯è¾¾çš„ IPï¼ˆå¦‚ç½‘ç»œé€šè¿‡BGPï¼ŒOSPFç­‰è·¯ç”±åè®®è¿›è¡Œå®£å‘Šè·¯ç”±å¯è¾¾é›†ç¾¤èŠ‚ç‚¹ï¼‰ ï¼Œå³"),t("strong",[s._v("é›†ç¾¤å¤–èƒ½é€šè¿‡è¿™ä¸ªIPè®¿é—®åˆ°é›†ç¾¤å†…çš„Nodeï¼ˆè‡³å°‘å…¶ä¸­ä¸€å°èŠ‚ç‚¹ï¼‰")]),s._v("ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¿™äº›Nodeå°†æµé‡è½¬å‘åˆ°Serviceï¼Œå¹¶æä¾›è´Ÿè½½å‡è¡¡ã€‚")]),s._v(" "),t("div",{staticClass:"center-container"},[t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://static.xiaoliutalk.cn/img/202309281443742.png"}})]),t("blockquote",[t("p",[s._v("ğŸ””  "),t("code",[s._v("external IP")]),s._v(" ä¸€èˆ¬ç”±æ•°æ®ä¸­å¿ƒæˆ–è€…ç½‘ç»œç®¡ç†å‘˜ç®¡ç†ï¼Œç‹¬ç«‹äºkubernetesä¹‹å¤–ã€‚")])]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" my"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("service\n"),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("selector")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("app.kubernetes.io/name")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("ports")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("protocol")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" TCP\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("port")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("targetPort")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("externalIPs")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" 192.168.7.30\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("è¿™ä¸ªå« "),t("code",[s._v("my-service")]),s._v(" çš„æœåŠ¡å¯ä»¥åœ¨ "),t("code",[s._v("192.168.7.30:80")]),s._v(" ä¸Šè¢«æ­£å¸¸è®¿é—®ã€‚")]),s._v(" "),t("h2",{attrs:{id:"_3-æœåŠ¡å‘ç°"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-æœåŠ¡å‘ç°"}},[s._v("#")]),s._v(" 3. æœåŠ¡å‘ç°")]),s._v(" "),t("p",[s._v("kubernetesæ”¯æŒä¸¤ç§ç±»å‹çš„æœåŠ¡å‘ç°ï¼šç¯å¢ƒå˜é‡å’ŒDNSã€‚")]),s._v(" "),t("h3",{attrs:{id:"_3-1-ç¯å¢ƒå˜é‡"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-ç¯å¢ƒå˜é‡"}},[s._v("#")]),s._v(" 3.1. ç¯å¢ƒå˜é‡")]),s._v(" "),t("p",[s._v("å½“Podéƒ¨ç½²åˆ°ä¸€ä¸ªNodeèŠ‚ç‚¹åï¼Œkubeletä¼šåœ¨å…¶ä¸­ä¸ºæ¯ä¸ªæ´»è·ƒçš„Serviceæ·»åŠ ä¸€ç»„ç¯å¢ƒå˜é‡ï¼Œå¹¶ä»¥ "),t("code",[s._v("{SERVICE_NAME}_SERVICE_HOST")]),s._v(" å’Œ "),t("code",[s._v("{SERVICE_NAME}_SERVICE_PORT")]),s._v(" æ ¼å¼å‘½åçš„å˜é‡ï¼Œå…¶ä¸­æœåŠ¡åéƒ½è½¬æ¢ä¸ºå¤§å†™å­—æ¯ï¼Œ"),t("code",[s._v(".")]),s._v(" å’Œ "),t("code",[s._v("-")]),s._v(" è½¬æ¢ä¸º "),t("code",[s._v("_")]),s._v(" ã€‚")]),s._v(" "),t("div",{staticClass:"language-yaml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-yaml"}},[t("code")]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"})]),t("h3",{attrs:{id:"_3-2-dns"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-dns"}},[s._v("#")]),s._v(" 3.2. DNS")]),s._v(" "),t("p",[s._v("å‚è€ƒæ–‡ç« åŠä¹¦ç±ï¼š")]),s._v(" "),t("ul",[t("li",[t("p",[t("a",{attrs:{href:"https://kubernetes.io/docs/concepts/services-networking/service/",target:"_blank",rel:"noopener noreferrer"}},[s._v("Service"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://product.dangdang.com/26439199.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes in Action"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://www.manning.com/books/kubernetes-in-action-second-edition",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetes in Action, Second Edition"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://product.dangdang.com/29222386.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("æ·±å…¥å‰–æKubernetes"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://product.dangdang.com/29404674.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("äº‘åŸç”ŸKuberneteså…¨æ ˆæ¶æ„å¸ˆå®æˆ˜"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://it.sohu.com/a/611171687_827544",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetesä¸Šåƒè§„æ¨¡Podæœ€ä½³å®è·µ "),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"https://blog.csdn.net/yang75108/article/details/101268208",target:"_blank",rel:"noopener noreferrer"}},[s._v("Kubernetesç½‘ç»œä¸‰éƒ¨æ›²ä¹‹ä¸‰ ~ NodePort vs LoadBalancer vs Ingress"),t("OutboundLink")],1)])]),s._v(" "),t("li",[t("p",[t("a",{attrs:{href:"http://arthurchiao.art/blog/cilium-k8s-service-lb-zh/",target:"_blank",rel:"noopener noreferrer"}},[s._v("[è¯‘] åŸºäº BPF/XDP å®ç° K8s Service è´Ÿè½½å‡è¡¡ (LPC, 2020)"),t("OutboundLink")],1)])])])])}),[],!1,null,null,null);t.default=n.exports}}]);